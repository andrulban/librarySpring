<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="css/main.css"/>

    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/ui-darkness/jquery-ui.css" rel="stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>

<script>
    showBooks('/getAll');
    showAllGenres();

    function deleteBook(id) {
        if (confirm('Do you really want to delete this book?')) {
            $.ajax({
                url: '/deleteBook/' + id,
                success: function (data) {
                    bookRepository.delete(id);
                }
            });
        }
//
    }

    function searchBooksByName() {
        if (document.getElementById('searchText').value === '') {
            showBooks('/getAll');
        }
        showBooks('/getBooksByName/' + document.getElementById('searchText').value);
    }

    function showAllGenres() {
        $.ajax({
            url: '/getAllGenres',
            success: function (data) {
                var rightContent = document.getElementById('genresDiv');

                var ulelem = document.createElement('ul');
                $.each(data, function (index, element) {
                    var line = document.createElement('li');
                    var genreHref = document.createElement('a');
                    genreHref.innerHTML = element.genreName;


                    genreHref.onclick = function () {
                        showBooks('/getBooksByGenreId/' + element.id);
                    };

                    line.appendChild(genreHref);
                    ulelem.appendChild(line);
                });
                rightContent.appendChild(ulelem);
            }

        });

    }

    function showBooks(url) {
        $.ajax({
            url: url,
            success: function (data) {
                var parent = document.getElementById('booksDiv');

                while (parent.firstChild) {
                    parent.removeChild(parent.firstChild);
                }

                var box_sh = document.createElement('div');
                box_sh.setAttribute('class', 'box-sh');

                var amountOfBooks = document.createElement('h1');
                amountOfBooks.innerHTML = data.length + ' books found';


                var addHref = document.createElement('a');
                addHref.innerHTML = 'Add';
                addHref.setAttribute('type', 'button');
                addHref.setAttribute('id', 'button');
                addHref.setAttribute('href', '/addBook')

                box_sh.appendChild(amountOfBooks);
                box_sh.appendChild(addHref);
                parent.appendChild(box_sh);


                $.each(data, function (index, element) {

                    var child = document.createElement('div');
                    child.setAttribute('class', 'item');
                    child.setAttribute('id', 'child');

                    var info = document.createElement('div');
                    info.setAttribute('class', 'info');

                    var clear = document.createElement('div');
                    clear.setAttribute('class', 'clear');

                    var img = document.createElement('img');
                    img.setAttribute('width', '100');
                    img.setAttribute('height', '147');
                    img.setAttribute('src', '/image/' + element.id);

                    var titleHref = document.createElement('a');
                    titleHref.setAttribute('class', 'title');
                    titleHref.setAttribute('href', '/content/read?id=' + element.id);
                    titleHref.setAttribute('target', '_blank');

                    var titleP = document.createElement('p');
                    titleP.innerHTML = element.name;

                    var readHref = document.createElement('a');
                    readHref.setAttribute('class', 'mr');
                    readHref.setAttribute('href', '/content/read?id=' + element.id);
                    readHref.setAttribute('target', '_blank');

                    var downloadHref = document.createElement('a');
                    downloadHref.setAttribute('class', 'mr');
                    downloadHref.setAttribute('href', '/content/download?id=' + element.id);
                    downloadHref.setAttribute('target', '_blank');

                    var editHref = document.createElement('a');
                    editHref.innerHTML = 'Edit';
                    editHref.setAttribute('class', 'mr');
                    editHref.setAttribute('href', '/editBook?id=' + element.id);

                    var deleteHref = document.createElement('a');
                    deleteHref.innerHTML = 'Delete';
                    deleteHref.setAttribute('class', 'delete-button');
                    deleteHref.setAttribute('onclick', 'deleteBook(' + element.id + ')');

                    var printed = document.createElement('p');
                    $.ajax({
                        url: '/getPublisherName/' + element.publisher_id,
                        success: function (data) {
                            printed.innerHTML = 'Publisher:' + data;
                        }
                    });

                    var year = document.createElement('p');
                    year.innerHTML = 'Publishing year: ' + element.publish_year;

                    var isbn = document.createElement('p');
                    isbn.innerHTML = 'ISBN code: ' + element.isbn;

                    var pages = document.createElement('p');
                    pages.innerHTML = 'Amount of pages: ' + element.pageCount;

                    var readP = document.createElement('p');
                    readP.innerHTML = 'Read';

                    var downloadP = document.createElement('p');
                    downloadP.innerHTML = 'Download';

                    var author = document.createElement('span');
                    $.ajax({
                        url: '/getAuthorName/' + element.author_id,
                        success: function (data) {
                            author.innerHTML = data;
                        }
                    });

                    titleHref.appendChild(titleP);

                    info.appendChild(titleHref);
                    info.appendChild(author);
                    info.appendChild(pages);
                    info.appendChild(printed);
                    info.appendChild(year);
                    info.appendChild(isbn);

                    downloadHref.appendChild(downloadP);
                    readHref.appendChild(readP);

                    child.appendChild(img);
                    child.appendChild(info);
                    child.appendChild(clear);
                    child.appendChild(downloadHref);
                    child.appendChild(readHref);
                    child.appendChild(editHref);
                    child.appendChild(deleteHref);


                    parent.appendChild(child);
                });

                var clear = document.createElement('div');
                clear.setAttribute('class', 'clear');
                parent.appendChild(clear);

            }
        });
    }
</script>

<div class="header">
    <div class="header-wrap">

        <div class="social">
            <a href="#"><img src="images/vk.jpg" width="16" height="16" alt=""/></a>
            <a href="#"><img src="images/facebook.jpg" width="16" height="16" alt=""/></a>
        </div>

        <div class="aut">
            <p>User</p>
            <a href="#">Exit</a>
        </div>
    </div>
</div>

<div id="wrap">

    <div class="logo">
        <a href="#"><img src="images/logo.png" width="211" height="46" alt=""/></a>
    </div>

    <div class="menu">
        <ul>
            <li><a href="#">Новинки</a></li>
            <li><a href="#">Популярные</a></li>
            <li><a href="#">О компании</a></li>
            <li><a href="#">Контакты</a></li>
            <li><a href="#">Команда</a></li>
        </ul>
    </div>

    <a class="feedback" href="#">Обратная связь</a>
    <div class="clear"></div>

    <div class="search">
        <input id="searchText" type="text" class="search-text" placeholder="Type name of a book"/>
        <input type="submit" class="button-text"/>

        <select>
            <option>Name</option>
        </select>

        <input type="submit" class="button" onclick="searchBooksByName()" value="Search"/>
    </div>
    <div class="clear"></div>


    <div class="nav">
        <ul>
            <li onclick="showBooks('/getBooksByLetter/A')"><a>A</a></li>
            <li onclick="showBooks('/getBooksByLetter/B')"><a>B</a></li>
            <li onclick="showBooks('/getBooksByLetter/C')"><a>C</a></li>
            <li onclick="showBooks('/getBooksByLetter/D')"><a>D</a></li>
            <li onclick="showBooks('/getBooksByLetter/E')"><a>E</a></li>
            <li onclick="showBooks('/getBooksByLetter/F')"><a>F</a></li>
            <li onclick="showBooks('/getBooksByLetter/G')"><a>G</a></li>
            <li onclick="showBooks('/getBooksByLetter/H')"><a>H</a></li>
            <li onclick="showBooks('/getBooksByLetter/I')"><a>I</a></li>
            <li onclick="showBooks('/getBooksByLetter/G')"><a>G</a></li>
            <li onclick="showBooks('/getBooksByLetter/K')"><a>K</a></li>
            <li onclick="showBooks('/getBooksByLetter/L')"><a>L</a></li>
            <li onclick="showBooks('/getBooksByLetter/M')"><a>M</a></li>
            <li onclick="showBooks('/getBooksByLetter/N')"><a>N</a></li>
            <li onclick="showBooks('/getBooksByLetter/O')"><a>O</a></li>
            <li onclick="showBooks('/getBooksByLetter/P')"><a>P</a></li>
            <li onclick="showBooks('/getBooksByLetter/Q')"><a>Q</a></li>
            <li onclick="showBooks('/getBooksByLetter/R')"><a>R</a></li>
            <li onclick="showBooks('/getBooksByLetter/S')"><a>S</a></li>
            <li onclick="showBooks('/getBooksByLetter/T')"><a>T</a></li>
            <li onclick="showBooks('/getBooksByLetter/U')"><a>U</a></li>
            <li onclick="showBooks('/getBooksByLetter/V')"><a>V</a></li>
            <li onclick="showBooks('/getBooksByLetter/W')"><a>W</a></li>
            <li onclick="showBooks('/getBooksByLetter/X')"><a>X</a></li>
            <li onclick="showBooks('/getBooksByLetter/Y')"><a>Y</a></li>
            <li onclick="showBooks('/getBooksByLetter/Z')"><a>Z</a></li>
        </ul>
    </div>

    <!-- content -->
    <div class="content" id="hui">
        <div class="left-menu" id="genresDiv"></div>
        <div class="right-content" id="booksDiv"></div>
    </div>

    <!-- footer -->
    <div class="footer_blank"></div>
</div>
<div id="footer">
    <div class="footer-wrap">
        <p>&#169; 2017 &#171;Andrii Tytarchuk&#187;</p>
    </div>
</div>

</body>
</html>
